# ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Production

## üéØ –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

–ü—Ä–æ–µ–∫—Ç –≥–æ—Ç–æ–≤ –∫ production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é **—Ç—Ä–µ–º—è —Å–ø–æ—Å–æ–±–∞–º–∏**:

```
‚úÖ –†–∞–∑–¥–µ–ª–µ–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏: development ‚Üî production
‚úÖ –°–µ–∫—Ä–µ—Ç—ã –≤—ã–Ω–µ—Å–µ–Ω—ã –≤ .env (–Ω–µ –≤ Git)
‚úÖ –°–æ–∑–¥–∞–Ω—ã —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è deploy/update/backup
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ Docker –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è üê≥
‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å config.cfg
```

---

## üöÄ –í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

### üê≥ **–°–ø–æ—Å–æ–± 1: Docker (–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è!)** ‚≠ê

**–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π - –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π –∑–∞–ø—É—Å–∫ –≤–µ–∑–¥–µ:**

```bash
# Development
docker-compose up -d

# Production
docker-compose -f docker-compose.production.yml up -d
```

üìñ **–°–º. [DOCKER_QUICKSTART.md](DOCKER_QUICKSTART.md)** –∏–ª–∏ **[DOCKER.md](DOCKER.md)**

---

### ‚öôÔ∏è **–°–ø–æ—Å–æ–± 2: –¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π (—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è)**

**–î–ª—è —Ç–µ—Ö, –∫—Ç–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Docker:**

```bash
# Development
python manage.py runserver

# Production
export DJANGO_ENV=production
python manage.py ...
# –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ ./scripts/deploy.sh
```

üìñ **–°–º. [CHEATSHEET.md](CHEATSHEET.md)** –∏–ª–∏ **[RUN_COMMANDS.md](RUN_COMMANDS.md)**

---

### üìú **–°–ø–æ—Å–æ–± 3: –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π (—Å—Ç–∞—Ä–∞—è —à–∫–æ–ª–∞)**

**–†—É—á–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Å–µ–≥–æ:**

üìñ **–°–º. [DEPLOYMENT.md](DEPLOYMENT.md)**

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ (–¥–ª—è —Å–ø—Ä–∞–≤–∫–∏)

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ (—Å–µ–π—á–∞—Å)

**–ù–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è!** –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ:

```bash
python manage.py runserver
```

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `config.cfg` –∏ `vikivostokweb.settings.development`

---

### Production —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

#### 1Ô∏è‚É£ –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ `.env`:

```bash
cp env.example .env
nano .env  # –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
```

#### 2Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –¥–µ–ø–ª–æ—è:

```bash
chmod +x scripts/*.sh
./scripts/deploy.sh
```

**–ò–ª–∏ –≤—Ä—É—á–Ω—É—é:**

```bash
export DJANGO_SETTINGS_MODULE=vikivostokweb.settings.production
pip install -r vikivostokweb/requirements/production.txt
python manage.py migrate
python manage.py collectstatic
```

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

### –ü—Ä–æ—Å—Ç–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:

```bash
./scripts/update.sh
```

### –° –º–∏–≥—Ä–∞—Ü–∏—è–º–∏ –ë–î:

```bash
./scripts/update.sh --with-migrations
```

### –°–æ–∑–¥–∞—Ç—å –±—ç–∫–∞–ø:

```bash
./scripts/backup.sh
```

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
vikivostokweb/
‚îú‚îÄ‚îÄ vikivostokweb/
‚îÇ   ‚îú‚îÄ‚îÄ settings/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ base.py          # –û–±—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ development.py   # Dev (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç config.cfg –∏–ª–∏ .env)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ production.py    # Prod (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç .env)
‚îÇ   ‚îî‚îÄ‚îÄ requirements/
‚îÇ       ‚îú‚îÄ‚îÄ base.txt         # –û–±—â–∏–µ –ø–∞–∫–µ—Ç—ã
‚îÇ       ‚îú‚îÄ‚îÄ development.txt  # + Dev –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
‚îÇ       ‚îî‚îÄ‚îÄ production.txt   # + Gunicorn, Whitenoise
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh           # –ü–µ—Ä–≤–∏—á–Ω–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ update.sh           # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ backup.sh           # –ë—ç–∫–∞–ø –ë–î –∏ —Ñ–∞–π–ª–æ–≤
‚îú‚îÄ‚îÄ env.example             # –ü—Ä–∏–º–µ—Ä .env —Ñ–∞–π–ª–∞
‚îú‚îÄ‚îÄ .gitignore              # .env –∏ config.cfg –∏—Å–∫–ª—é—á–µ–Ω—ã
‚îú‚îÄ‚îÄ README_SETTINGS.md      # –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
‚îî‚îÄ‚îÄ DEPLOYMENT.md           # –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### ‚úÖ –ó–∞—â–∏—â–µ–Ω–æ:

- `.env` –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Git
- `config.cfg` –Ω–µ –ø–æ–ø–∞–¥–∞–µ—Ç –≤ Git
- Production –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `DEBUG=False`
- –í–∫–ª—é—á–µ–Ω—ã security headers (HSTS, XSS, etc.)
- Secure cookies –¥–ª—è HTTPS

### ‚ö†Ô∏è –í–∞–∂–Ω–æ:

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –Ω–æ–≤—ã–π SECRET_KEY –¥–ª—è production:
python -c "from django.core.management.utils import get_random_secret_key; print(get_random_secret_key())"

# –î–æ–±–∞–≤—å—Ç–µ –≤ .env:
SECRET_KEY=<—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π-–∫–ª—é—á>
```

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| **README_SETTINGS.md** | –ü–æ–¥—Ä–æ–±–Ω–æ –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è |
| **DEPLOYMENT.md** | –ü–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è: Nginx, Gunicorn, Celery, SSL |
| **env.example** | –ü—Ä–∏–º–µ—Ä –≤—Å–µ—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è |

---

## ‚ùì FAQ

**Q: –ù—É–∂–Ω–æ –ª–∏ —á—Ç–æ-—Ç–æ –º–µ–Ω—è—Ç—å –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã?**  
A: –ù–µ—Ç! –í—Å—ë –ø—Ä–æ–¥–æ–ª–∂–∏—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å `config.cfg`.

**Q: –ö–∞–∫ –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –º–µ–∂–¥—É dev –∏ prod?**  
A: –ß–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
# Development (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python manage.py runserver

# Production
export DJANGO_SETTINGS_MODULE=vikivostokweb.settings.production
python manage.py runserver
```

**Q: –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å .env –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ?**  
A: –í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```
/var/www/vikivostok/.env
```

**Q: –ö–∞–∫ –æ–±–Ω–æ–≤–ª—è—Ç—å –ø—Ä–æ–µ–∫—Ç –±–µ–∑ –ø—Ä–æ—Å—Ç–æ—è?**  
A: –°–º. —Ä–∞–∑–¥–µ–ª "Zero-downtime deployment" –≤ DEPLOYMENT.md

---

## üõ†Ô∏è –ö–æ–º–∞–Ω–¥—ã –¥–ª—è production

```bash
# –ó–∞–ø—É—Å–∫
gunicorn vikivostokweb.wsgi:application --bind 0.0.0.0:8000

# –ú–∏–≥—Ä–∞—Ü–∏–∏
python manage.py migrate --settings=vikivostokweb.settings.production

# –°—Ç–∞—Ç–∏–∫–∞
python manage.py collectstatic --settings=vikivostokweb.settings.production

# Celery worker
celery -A vikivostokweb worker -l info

# –õ–æ–≥–∏ (systemd)
sudo journalctl -u vikivostok -f
```

---

## ‚ú® –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

1. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** - —Å–µ–∫—Ä–µ—Ç—ã –Ω–µ –≤ Git
2. **–ì–∏–±–∫–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –æ–∫—Ä—É–∂–µ–Ω–∏—è–º–∏
3. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π** - `git pull && ./scripts/update.sh`
4. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** - —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —Ç–∏–ø–æ–≤—ã—Ö –∑–∞–¥–∞—á
5. **–î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –≤—Å—ë –æ–ø–∏—Å–∞–Ω–æ –≤ .md —Ñ–∞–π–ª–∞—Ö
6. **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–π config.cfg –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å

---

## üìû –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ README_SETTINGS.md** - –¥–µ—Ç–∞–ª–∏ –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
2. ‚úÖ **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ DEPLOYMENT.md** - –ø–æ–ª–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
3. ‚úÖ **–°–æ–∑–¥–∞–π—Ç–µ .env** –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ –∏–∑ env.example
4. ‚úÖ **–ó–∞–ø—É—Å—Ç–∏—Ç–µ** `./scripts/deploy.sh` –¥–ª—è –ø–µ—Ä–≤–∏—á–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
5. ‚úÖ **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ** –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã —á–µ—Ä–µ–∑ cron

---

**–ì–æ—Ç–æ–≤–æ –∫ production! üöÄ**

