(()=>{"use strict";var e,t,a,n,o={12:(e,t,a)=>{function n(e,t){[...t.querySelectorAll("input")].forEach((t=>{t.value=e[t.dataset.name]}))}a.d(t,{Z:()=>n})},90:(e,t,a)=>{function n(e,t){const a=t.closest("dialog"),n=a.querySelector(".alert");n&&(n.textContent=null),a.close()}a.d(t,{p:()=>n})},223:(e,t,a)=>{function n(e,t,a){document.querySelector("#price");const n=document.querySelector("#price_dropdown"),l=document.querySelector("#price_id"),r=n?.querySelector(".viki-dropdown__trigger-text"),c=n?.querySelector(".viki-dropdown__menu");a&&(l.value=a),e&&t&&t.length&&n&&(t.forEach((t=>{const n=document.createElement("li");n.className="viki-dropdown__menu-item",n.dataset.id=t.id,n.textContent=t.name,a&&t.id===a&&(r.textContent=t.name),n.addEventListener("click",(()=>{!function(e,t,a){if(!a)return;const n=document.querySelector("#price"),o=document.querySelector("#price_dropdown"),l=document.querySelector("#price_id");o.querySelector(".viki-dropdown__trigger-text").textContent=t,n.value=t,l.value=e}(t.id,t.name,e),o(!1)})),c.appendChild(n)})),n.querySelector(".viki-dropdown__trigger").addEventListener("click",(()=>{o()})),document.addEventListener("click",(e=>{n.contains(e.target)||o(!1)})))}function o(e){const t=document.querySelector("#price_dropdown");t&&(void 0!==e?t.classList.toggle("viki-dropdown--open",e):t.classList.toggle("viki-dropdown--open"))}function l(e){if(!e)return;const t=document.querySelector("#price"),a=document.querySelector("#price_dropdown");t.classList.add("item-hidden"),a.classList.remove("item-hidden")}function r(e){if(!e)return;const t=document.querySelector("#price"),a=document.querySelector("#price_dropdown");t.classList.remove("item-hidden"),a.classList.add("item-hidden"),o(!1)}a.d(t,{KF:()=>r,O:()=>n,xk:()=>l})},233:(e,t,a)=>{a.a(e,(async(e,n)=>{try{a.d(t,{_d:()=>q,lQ:()=>S});var o=a(301),l=a(339),r=a(495),c=a(790),s=a(739),d=a(90),i=a(446),u=a(660),p=a(535),y=a(223),m=e([s,u]);[s,u]=m.then?(await m)():m;const _=document.querySelectorAll("input.input-disabled"),b=document.querySelector(".personal-data"),v=document.querySelector(".legal-data"),f=document.querySelector("#company-dialog"),S=document.querySelector("#company-dialog-save"),h=document.querySelector("#bank-dialog"),q=document.querySelector("#bank-dialog-save");document.querySelector("li.log-logout").style.display="none";const k=await(0,r.y)(b,v),g=k.personalData,w=k.isStaff||!1,E=k.priceTypes||[];(0,y.O)(w,E,g.price_id),(0,o.q)(),await(0,l.I)(b,g,"#first_name","personal",w);const L=document.querySelector("#new-company");L&&L.addEventListener("click",(e=>{f.showModal(),(0,i.Y)(f)})),f.querySelector("form").addEventListener("submit",(async e=>{await(0,s.s)(e,f)})),f.querySelector("form").addEventListener("reset",(e=>{(0,d.p)(e,f)})),S.querySelector("form").addEventListener("submit",(async e=>{await(0,c.J)(e,S)})),S.querySelector("form").addEventListener("reset",(async e=>{(0,d.p)(e,S)}));const x=document.querySelector("#new-bank");x&&x.addEventListener("click",(e=>{const t=e.target.closest(".company").querySelector('input[name="id"]').value;h.querySelector("form").dataset.companyId=t,h.showModal(),(0,i.Y)(h)})),h.querySelector("form").addEventListener("submit",(async e=>{const t=e.target.dataset.companyId;await(0,u.V)(e,h,t)})),h.querySelector("form").addEventListener("reset",(e=>{(0,d.p)(e,h)})),q.querySelector("form").addEventListener("submit",(async e=>{await(0,p.w)(e,q)})),q.querySelector("form").addEventListener("reset",(e=>{(0,d.p)(e,q)})),[..._].forEach((e=>{e.addEventListener("mousedown",(t=>{e.classList.remove("alert-border"),e.closest("form").querySelector(".alert").textContent=""}))})),n()}catch(e){n(e)}}),1)},301:(e,t,a)=>{function n(){[...document.querySelectorAll(".input-disabled")].forEach((e=>{e.disabled=!0}))}a.d(t,{q:()=>n})},339:(e,t,a)=>{a.d(t,{I:()=>r});var n=a(223),o=a(12),l=a(591);async function r(e,t,a,r,c){const s=e.querySelector(".btn__neutral"),d=e.querySelector(".btn__save"),i=e.querySelector(".btn__cancel");s.addEventListener("click",(t=>{!function(e,t){const a=e.querySelector(".personal-data__change"),o=e.querySelector(".personal-data__save");a.classList.toggle("item-hidden"),o.classList.toggle("item-hidden"),[...e.querySelectorAll(".input-disabled")].forEach((e=>{e.disabled=!1})),e.querySelector(".alert").textContent="",(0,n.xk)(t)}(e,c),e.querySelector(a).focus()})),i.addEventListener("click",(a=>{!function(e,t,a){const l=t.querySelector(".personal-data__change"),r=t.querySelector(".personal-data__save");l.classList.toggle("item-hidden"),r.classList.toggle("item-hidden"),[...t.querySelectorAll(".input-disabled")].forEach((e=>{e.disabled=!0,e.classList.remove("alert-border")})),e&&(0,o.Z)(e,t),t.querySelector(".alert").textContent="",(0,n.KF)(a)}(t,e,c)})),d.addEventListener("click",(async t=>{await async function(e,t){const a="/cabinet/save/"+t,n=await(0,l.h)(a,e);"ok"===n.status?window.location.reload():(e.querySelector(".alert").textContent=n.message,n.field&&e.querySelector(`#${n.field}`).classList.add("alert-border"))}(e,r)}))}},446:(e,t,a)=>{function n(e){let t,a,n=!1;e.querySelector(".login__title").addEventListener("mousedown",(o=>{n=!0,t=o.clientX-e.offsetLeft,a=o.clientY-e.offsetTop,e.style.cursor="grabbing"})),document.addEventListener("mousemove",(o=>{n&&(e.style.left=o.clientX-t+"px",e.style.top=o.clientY-a+"px")})),document.addEventListener("mouseup",(()=>{n=!1,e.style.cursor="grab"}))}a.d(t,{Y:()=>n})},495:(e,t,a)=>{a.d(t,{y:()=>u});var n=a(12),o=a(964);const l='\n            <details class="company" id="company-detail-0">\n                <summary class="company__summary">\n                        <div class="personal-data__block">\n                            <label for="company-name-0" class="personal-data__label"></label>\n                            <input type="text" id="company-name-0" \n                                   class="personal-data__input"\n                                   data-name="name"\n                                   disabled>\n                        </div>\n                        <div class="personal-data__change legal-data__change">\n                                    <button class="btn btn__neutral legal-btn"\n                                            type="button"\n                                            data-id="company-0">Изменить НДС\n                                    </button>\n                        </div>\n                        <div class="personal-data__save company__data-save item-hidden">\n                            <div class="company__save">\n                                <button class="btn btn__save personal-btn"\n                                        type="button"\n                                        data-id="company-0">Сохранить\n                                </button>\n                                <button class="btn btn__cancel personal-btn"\n                                        type="button" data-id="company-0">Отменить\n                                </button>\n                            </div>\n                            <div class="alert company-alert"></div>\n                        </div>\n                </summary>\n                <div class="legal-data__inputs">\n                    <div class="personal-data__inputs">\n                        <form id="company-0" class="legal-data__block">\n                        <input type="text" data-name="id" name="id" hidden>\n                            <div class="personal-data__block">\n                                <label for="inn-0" class="personal-data__label">ИНН</label>\n                                <input type="text" id="inn-0"\n                                       class="personal-data__input"\n                                       name="inn"\n                                       data-name="inn"\n                                       disabled>\n                            </div>\n                            <div class="personal-data__block">\n                                <label for="company-kpp-0" class="personal-data__label">КПП</label>\n                                <input type="text" \n                                       id="company-kpp-0" \n                                       class="personal-data__input" \n                                       data-name="kpp" \n                                       disabled>\n                            </div>\n                            <div class="personal-data__block">\n                                <input type="checkbox" id="company-vat-0"\n                                       class="input-disabled check"\n                                       name="vat" \n                                       data-name="vat">\n                                <label for="vat-0" class="personal-data__label">с НДС</label>\n                            </div>\n                        </form>\n                        <div class="personal-data__block">\n                            <label for="company-address-0" class="personal-data__label">Адрес</label>\n                            <input type="text" \n                                   id="company-address-0" \n                                   class="personal-data__input" \n                                   data-name="address" \n                                   disabled>\n                        </div>\n                        <div class="legal-data__title">\n                            <h4>Банковские реквизиты</h4>\n                            <div></div>\n                            <button class="btn btn__cancel legal-btn" type="button" id="new-bank">Добавить</button>\n                        </div>\n                        <div id="company-bank-0"></div>\n                    </div>\n                    <div class="personal-data__inputs">\n            </details>\n',r='\n                    <hr class="hr">\n                    <details class="bank " id="bank-0">\n                        <summary class="">\n                            <input type="text" \n                            id="bank-name-0" \n                            class="bank__name"\n                            data-name="name" \n                            disabled>\n                        </summary>\n                        <form class="legal-data__inputs">\n                        <input type="text" data-name="id" name="id" hidden>\n                        <input type="text" data-name="company_id" name="company_id" hidden>\n                        <div class="personal-data__inputs">\n                            <div class="personal-data__block">\n                                <label for="account-0" class="personal-data__label">Счет</label>\n                                <input type="text" id="account-0"\n                                       class="personal-data__input"\n                                       name="account_no" \n                                       data-name="account_no"\n                                       disabled>\n                            </div>\n                            <div class="legal-data__block">\n                                <div class="personal-data__block">\n                                    <label for="bic-0" class="personal-data__label">БИК</label>\n                                    <input type="text" id="bic-0"\n                                           class="personal-data__input"\n                                           name="bic" \n                                           data-name="bic" \n                                           disabled>\n                                </div>\n                                <div class="personal-data__block">\n                                    <label for="city-0" class="personal-data__label">Город</label>\n                                    <input type="text" id="city" \n                                           class="personal-data__input" \n                                           data-name="city"\n                                           disabled>\n                                </div>\n                            </div>\n                            <div class="personal-data__block">\n                                <label for="corr-account-0" class="personal-data__label">Кор. счет</label>\n                                <input type="text" \n                                       id="corr-account-0" \n                                       class="personal-data__input" \n                                       data-name="corr_account" \n                                       disabled>\n                            </div>\n                        </div>\n                        <div class="personal-data__inputs">\n                            <div class="personal-data__change legal-data__change">\n                                <button class="btn btn__neutral legal-btn"\n                                    type="button"\n                                    data-id="company-0">Удалить\n                                </button>\n                            </div>\n                            <div class="personal-data__save item-hidden">\n                            <button class="btn btn__save personal-btn"\n                                    type="button"\n                                    data-id="company-0">Удалить\n                            </button>\n                            <button class="btn btn__cancel personal-btn"\n                                    type="button" data-id="company-0">Отменить\n                            </button>\n                            <div class="alert company-alert"></div>\n                        </div>\n                        </div>\n\n                        </form>\n                    </details>\n';function c(e){const t=e.querySelector(".personal-data__change"),a=e.querySelector(".personal-data__save");t.classList.toggle("item-hidden"),a.classList.toggle("item-hidden"),[...e.querySelector("form").querySelectorAll(".input-disabled")].forEach((e=>{e.disabled=!1})),e.querySelector(".alert").textContent=""}function s(e,t){const a=t.querySelector(".personal-data__change"),o=t.querySelector(".personal-data__save");a.classList.toggle("item-hidden"),o.classList.toggle("item-hidden");const l=t.querySelector("form");[...l.querySelectorAll(".input-disabled")].forEach((e=>{e.disabled=!0,e.classList.remove("alert-border")})),e&&(0,n.Z)(e,l),t.querySelector(".alert").textContent=""}var d=a(591);async function i(e,t){const a=e.querySelector("form"),n="/cabinet/save/"+t,o=await(0,d.h)(n,a);"ok"===o.status?window.location.reload():(e.querySelector(".alert").textContent=o.message,o.field&&a.querySelector(`input[data-name="${o.field}"`).classList.add("alert-border"))}async function u(e,t){const a=await fetch("/cabinet_data/",{method:"GET",headers:{"Content-Type":"application/json","X-CSRFToken":(0,o.m)()}}).then((e=>e.json()));return"ok"===a.status&&((0,n.Z)(a.data.personalData,e),function(e,t){e.length&&e.forEach((e=>{const a=l.replaceAll("-0","-"+e.id);t.insertAdjacentHTML("beforeend",a);const n=t.lastElementChild,o=document.createElement("hr");n.insertAdjacentElement("beforebegin",o),o.classList.add("hr"),[...n.querySelectorAll("input")].forEach((t=>{"checkbox"===t.type?t.checked=e[t.dataset.name]:t.value=e[t.dataset.name]})),n.querySelector("button.btn__neutral").addEventListener("click",(()=>{c(n)})),n.querySelector("button.btn__cancel").addEventListener("click",(()=>{s(e,n)})),n.querySelector("button.btn__save").addEventListener("click",(async()=>{await i(n,"company")}));const d=n.querySelector(`#company-bank-${e.id}`);e.bank.length&&e.bank.forEach((e=>{const t=r.replaceAll("-0","-"+e.id);d.insertAdjacentHTML("beforeend",t);const a=d.lastElementChild;a.querySelector("button.btn__neutral").addEventListener("click",(()=>{c(a)})),a.querySelector("button.btn__cancel").addEventListener("click",(()=>{s(e,a)})),a.querySelector("button.btn__save").addEventListener("click",(async()=>{await i(a,"bank")})),[...a.querySelectorAll("input")].forEach((t=>{t.value=e[t.dataset.name]}))}))}))}(a.data.legalData,t)),a.data}},535:(e,t,a)=>{a.d(t,{w:()=>o});var n=a(591);async function o(e,t){e.preventDefault();const a=t.querySelector("form"),o=await(0,n.h)("/save_bank_account/",a);"ok"===o.status?(t.close(),window.location.reload()):t.querySelector(".alert").textContent=o.message}},591:(e,t,a)=>{a.d(t,{h:()=>o});var n=a(964);async function o(e,t){const a=new FormData(t),o=await fetch(e,{method:"POST",body:a,headers:{"X-CSRFToken":(0,n.m)()}});return await o.json()}},660:(e,t,a)=>{a.a(e,(async(e,n)=>{try{a.d(t,{V:()=>s});var o=a(591),l=a(233),r=a(446),c=e([l]);async function s(e,t,a){e.preventDefault();const n=t.querySelector("form"),c=await(0,o.h)("/check_bank/",n);"ok"===c.status?([...l._d.querySelectorAll("input")].forEach((e=>{"hidden"===e.type?e.value=a:e.value=c.bank[e.name]})),t.close(),l._d.showModal(),(0,r.Y)(l._d)):t.querySelector(".alert").textContent=c.message}l=(c.then?(await c)():c)[0],n()}catch(d){n(d)}}))},739:(e,t,a)=>{a.a(e,(async(e,n)=>{try{a.d(t,{s:()=>s});var o=a(591),l=a(233),r=a(446),c=e([l]);async function s(e,t){e.preventDefault();const a=t.querySelector("form"),n=await(0,o.h)("/check_company/",a);"ok"===n.status?([...l.lQ.querySelectorAll("input, textarea")].forEach((e=>{"checkbox"===e.type?e.checked=n.company[e.name]:(e.type,e.value=n.company[e.name])})),t.close(),l.lQ.showModal(),(0,r.Y)(l.lQ)):t.querySelector(".alert").textContent=n.message}l=(c.then?(await c)():c)[0],n()}catch(d){n(d)}}))},790:(e,t,a)=>{a.d(t,{J:()=>o});var n=a(591);async function o(e,t){e.preventDefault();const a=t.querySelector("form"),o=await(0,n.h)("/save_new_company/",a);"ok"===o.status?(t.close(),window.location.reload()):t.querySelector(".alert").textContent=o.message}},964:(e,t,a)=>{function n(){return document.cookie.split("; ").find((e=>e.startsWith("csrftoken=")))?.split("=")[1]}a.d(t,{m:()=>n})}},l={};function r(e){var t=l[e];if(void 0!==t)return t.exports;var a=l[e]={exports:{}};return o[e](a,a.exports,r),a.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",a="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",n=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},r.a=(o,l,r)=>{var c;r&&((c=[]).d=-1);var s,d,i,u=new Set,p=o.exports,y=new Promise(((e,t)=>{i=t,d=e}));y[t]=p,y[e]=e=>(c&&e(c),u.forEach(e),y.catch((e=>{}))),o.exports=y,l((o=>{var l;s=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var l=[];l.d=0,o.then((e=>{r[t]=e,n(l)}),(e=>{r[a]=e,n(l)}));var r={};return r[e]=e=>e(l),r}}var c={};return c[e]=e=>{},c[t]=o,c})))(o);var r=()=>s.map((e=>{if(e[a])throw e[a];return e[t]})),d=new Promise((t=>{(l=()=>t(r)).r=0;var a=e=>e!==c&&!u.has(e)&&(u.add(e),e&&!e.d&&(l.r++,e.push(l)));s.map((t=>t[e](a)))}));return l.r?d:r()}),(e=>(e?i(y[a]=e):d(p),n(c)))),c&&c.d<0&&(c.d=0)},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r(233)})();